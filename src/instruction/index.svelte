<script lang="ts">
    import * as UIkit from 'uikit';
    import type { VpnConfig } from '../database';
    import Docker from './docker.svelte';

    interface Props {
        config: VpnConfig
    }

    let { config }: Props = $props();

    const onConnectClick = function(): void {
        window.location.href = config.hiddifyOpenUrl;
    };

    let accordion: HTMLElement;
    let accourdionList: HTMLElement[] = [];

    const onSwitchAccorion = function(index: number): void {
        UIkit.accordion(accordion).toggle(index);
        if (window.innerWidth < 768) {
            accourdionList[index - 1]?.scrollIntoView({ behavior: 'smooth' });
        }
    };

    let dockerConfig = $state(null);
</script>

<div class="uk-padding uk-card uk-card-default uk-card-body">
    <ul uk-accordion bind:this={accordion}>
        <li bind:this={accourdionList[0]} class="uk-open">
            <a class="uk-accordion-title" href>–®–∞–≥ 1: —Å–∫–∞—á–∞–π <b>Hiddify</b></a>
            <div class="uk-accordion-content">
                <p>–í—ã–±–µ—Ä–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</p>
                <div class="" uk-grid>
                    <ul class="uk-list uk-list-divider uk-width-1-4@m uk-width-1-2">
                        <li>
                            <a class="uk-link" href="https://apps.apple.com/us/app/hiddify-proxy-vpn/id6596777532" target="_blank">üì± iPhone</a>
                        </li>
                        <li>
                            <a class="uk-link" href="https://apps.apple.com/us/app/hiddify-proxy-vpn/id6596777532" target="_blank">üì± iPad</a>
                        </li>
                        <li>
                            <a class="uk-link" href="https://play.google.com/store/apps/details?id=app.hiddify.com" target="_blank">üì± Android</a>
                        </li>
                    </ul>
                    <ul class="uk-list uk-list-divider uk-width-1-4@m uk-width-1-2">
                        <li>
                            <a class="uk-link" href="https://apps.apple.com/us/app/hiddify-proxy-vpn/id6596777532" target="_blank">üíª macOS</a>
                        </li>
                        <li>
                            <a class="uk-link" href="https://play.google.com/store/apps/details?id=app.hiddify.com" target="_blank">üñ•Ô∏è Windows</a>
                        </li>
                        <li>
                            <a class="uk-link" href="https://github.com/hiddify/hiddify-app/releases/latest" target="_blank">üñ•Ô∏è Linux</a>
                        </li>
                    </ul>
                    <ul class="uk-list uk-list-divider uk-width-1-4@m uk-width-1-2">
                        <li>
                            <a class="uk-link" href="https://apps.apple.com/us/app/hiddify-proxy-vpn/id6596777532" target="_blank">üì∫ Apple TV</a>
                        </li>
                        <li>
                            <a class="uk-link" href="https://play.google.com/store/apps/details?id=app.hiddify.com" target="_blank">üì∫ Android TV</a>
                        </li>
                    </ul>
                    <ul class="uk-list uk-list-divider uk-width-1-4@m uk-width-1-2">
                        <li>
                            <Docker bind:config={dockerConfig} />
                            {dockerConfig}
                            <a class="uk-link uk-text-small" onclick={() => dockerConfig = config}>üê≥ Socks5 Docker</a>
                        </li>
                        <li>
                            <a class="uk-link uk-text-small" href={config.xrayClientConfigUrl} target="_blank">‚öôÔ∏è Xray client config</a>
                        </li>
                    </ul>
                </div>
                <p>–ö–∞–∫ —Å–∫–∞—á–∞–µ—à—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—à—å, –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è –æ–±—Ä–∞—Ç–Ω–æ –∏ –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ì–æ—Ç–æ–≤–æ!"</p>
                <div class="uk-text-center">
                    <button class="uk-button uk-button-primary" onclick={() => onSwitchAccorion(1)}>–ì–æ—Ç–æ–≤–æ!</button>
                </div>
            </div>
        </li>
        <li bind:this={accourdionList[1]}>
            <a class="uk-accordion-title" href>–®–∞–≥ 2: –≤—ã–∫–ª—é—á–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ <b>—Ä–æ—Å—Å–∏–π—Å–∫–∏–µ</b> —Ä–µ—Å—É—Ä—Å—ã</a>
            <div class="uk-accordion-content">
                <p class="uk-text-italic uk-text-small uk-text-muted">...—á—Ç–æ–±—ã –Ω–µ –≤–∫–ª—é—á–∞—Ç—å –∏ –≤—ã–∫–ª—é—á–∞—Ç—å –≤–ø–Ω –∫–∞–∂–¥—ã–π —Ä–∞–∑</p>
                <ol>
                    <li>–û—Ç–∫—Ä–æ–π <b>Hiddify</b></li>
                    <li>–ù–∞–∂–º–∏ –Ω–∞ <b>Settings</b> (–∫–Ω–æ–ø–∫–∞ —Å —à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∞–º–∏) –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ –≤ Hiddify</li>
                    <li>–ü—Ä–æ–ª–∏—Å—Ç–∞–π –¥–æ —Å–µ–∫—Ü–∏–∏ <b>Route Options</b> (3-—è —Å–µ–∫—Ü–∏—è)</li>
                    <li>–ù–∞–∂–º–∏ –Ω–∞ <b>Region</b> (–ø–µ—Ä–≤—ã–π –≤ —Å–µ–∫—Ü–∏–∏)</li>
                    <li>–í—ã–±–µ—Ä–∏ <b>Russia (ru)</b></li>
                    <li>–ó–∞–∫—Ä–æ–π <b>Hiddify</b></li>
                </ol>
                <div class="uk-text-center uk-margin-top">
                    <button class="uk-button uk-button-primary" onclick={() => onSwitchAccorion(2)}>–ì–æ—Ç–æ–≤–æ!</button>
                </div>
            </div>
        </li>
        <li bind:this={accourdionList[2]}>
            <a class="uk-accordion-title" href>–®–∞–≥ 3: <b>–ø–æ–¥–∫–ª—é—á–∏ –í–ü–ù</b></a>
            <div class="uk-accordion-content">
                <p>
                    –ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É <b>–ü–æ–¥–∫–ª—é—á–∏—Ç—å –í–ü–ù</b> –≤–Ω–∏–∑—É.<br/>
                    –û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–æ–ª–∂–Ω–æ –≤—ã—Å–∫–æ—á–∏—Ç—å –∑–µ–ª–µ–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, —á—Ç–æ –í–ü–ù –¥–æ–±–∞–≤–ª–µ–Ω.
                </p>
                <div class="uk-text-center">
                    <button class="uk-button uk-button-danger uk-button-large" onclick={onConnectClick}><b>–ü–æ–¥–∫–ª—é—á–∏—Ç—å –í–ü–ù</b></button>
                </div>
                <p>
                    –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞–∂–º–∏ –Ω–∞ –±–æ–ª—å—à—É—é –∫–Ω–æ–ø–∫—É <b>Connect</b> –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —ç–∫—Ä–∞–Ω–∞.
                </p>
                <p>
                    –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–∫–æ–ø–∏—Ä—É–π —Ç–µ–∫—Å—Ç –Ω–∏–∂–µ –∏ –≤—Å—Ç–∞–≤—å –µ–≥–æ –≤ Hiddify:
                </p>
                <p class="uk-text-center">
                    <code>{config.hiddifySubscriptionUrl}</code>
                </p>
            </div>
        </li>
    </ul>
</div>

<style lang="scss">
    .download-link {
        max-width: 10rem;
        cursor: pointer;
    }

    code {
        text-wrap: auto;
    }
</style>
